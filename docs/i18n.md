# i18n (PT / EN / ZH) — DJT Quest

## Objetivo
- Idioma escolhido no login (PT padrão; EN e ZH disponíveis).
- Preferência persistente:
  - `localStorage` (`djt_locale`)
  - `profiles.locale` (Supabase) quando o usuário está logado
- Fallback obrigatório: `pt-BR`
- Chaves estáveis (não mudar chaves já publicadas).

## Onde ficam as traduções
- Dicionários:
  - `locales/pt-BR.json`
  - `locales/en.json`
  - `locales/zh-CN.json`

## Como usar no frontend
- Provider/hook: `src/contexts/I18nContext.tsx`
- Exemplo:
  - `const { t, locale } = useI18n()`
  - `t("nav.home")`
  - `t("dashboard.progressRemaining", { xp: 120, next: "Bronze II" })`
- Datas: use `toLocaleDateString(locale, ...)` para respeitar o idioma.

## Regras (anti-regressão)
1) Sempre adicionar a mesma chave nos 3 idiomas.
2) Placeholders devem bater 1:1 entre idiomas (`{xp}`, `{title}`, etc).
3) Nunca sobrescrever texto original do usuário (fórum, respostas longas, etc). Traduções são cache/derivadas.
4) `NEXT_PUBLIC_I18N_ENABLED` controla o recurso no frontend (default: ligado).

## UI “i18n-safe” (layout resiliente)
- Evite larguras fixas baseadas em texto.
- Botões:
  - 1 linha + `truncate` quando necessário
  - tooltip/`title` + `aria-label` com texto completo quando truncar
- Cards/descrições: permitir até 2 linhas (`line-clamp-2`).
- Não forçar `uppercase` (ZH quebra expectativa).

## Validação local
- Checar consistência das chaves/placeholder entre idiomas:
```bash
npm run i18n:check
```

